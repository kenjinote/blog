---
title: 'Mathematicaで巡回セールスマン問題を解く'
date: 2022-10-12T19:05:58+09:00
tags: ["Mathematica", "巡回セールスマン問題", "アルゴリズム"]
draft: false
cover:
  image: "img.png"
  relative: true
---
# Mathematicaで巡回セールスマン問題を解く

## 問題
{{<twitter user="hayamizu_lab" id="1579806418982825984">}}

## 解法

```
d=SparseArray[{{1,2}->10,{2,1}->10,{1,5}->15,{5,1}->15,{1,4}->12,{4,1}->12,{1,3}->20,{3,1}->20,{2,5}->10,{5,2}->10,{3,4}->10,{4,3}->10,{3,8}->30,{8,3}->30,{3,7}->20,{7,3}->20,{3,6}->25,{6,3}->25,{4,5}->15,{5,4}->15,{4,8}->20,{8,4}->20,{5,9}->18,{9,5}->18,{5,8}->15,{8,5}->15,{6,7}->5,{7,6}->5,{7,8}->35,{8,7}->35,{8,9}->12,{9,8}->12},{9,9},Infinity];
```

SparseArray関数で行列を作成する。それぞれの要素は、その要素の行と列の都市間の距離を表します。例えば、最初の要素`{1,2}->10`は、1と2の距離が10という意味です。最後から2番目の要素`{9,9}`は行列の大きさを示していて、最後の要素`Infinity`は、指定していない都市間の道の長さが無限。つまり道がないことを意味します。

```
{len,tour}=FindShortestTour[{1,2,3,4,5,6,7,8,9},DistanceFunction->(d[[#1,#2]]&)]
```

FindShortestTour関数で、簡単に巡回セールスマン問題を解くことができます。`{1,2,3,4,5,6,7,8,9}`は、都市の番号を表します。`DistanceFunction->(d[[#1,#2]]&)`は、都市間の距離を表す行列dを渡しています。

## 出力

```
{137, {1, 2, 5, 9, 8, 7, 6, 3, 4}}
```

出力は、最短距離と、そのときの巡回路です。最短距離は`137`、巡回路は`1→2→5→9→8→7→6→3→4→1`となります。ABCの順に直すと`A, B, E, I, H, G, F, C, D`となります。